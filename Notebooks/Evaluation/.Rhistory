walmart.sale <- read.csv("..\\..\\Data\\task_4_2.csv")
head(walmart.eval)
nrow(walmart.eval)
rm(list=ls())
gc(reset=TRUE)
library(ggplot2)
library(ggplot2)
library(dplyr)
library(car)
library(ggplot2)
library(dplyr)
library(car)
walmart.sale <- read.csv("..\\..\\Data\\task_4_2.csv")
walmart.eval <- read.csv("..\\..\\Data\\task_5.csv")
head(walmart.eval)
y <- walmart.eval['weekly_revenue']
# Plot the cusum
plot(y)
y <- walmart.eval['week_id','weekly_revenue']
(y)
# Plot the cusum
plot(y)
# Plot the cusum
gplot(data=y, aes(x=week_id, y=weekly_revenue, group=1)) +geom_line(color="red")+geom_point()+ggtitle("Fig2:Line Chart of Avg expenses over 20 Yrs")+theme_excel()
# Plot the cusum
ggplot(data=y, aes(x=week_id, y=weekly_revenue, group=1)) +geom_line(color="red")+geom_point()+ggtitle("Fig2:Line Chart of Avg expenses over 20 Yrs")+theme_excel()
install.packages(gplot)
install.packages('gplot')
library(gplot)
# Plot the cusum
gplot(data=y, aes(x=week_id, y=weekly_revenue, group=1)) +geom_line(color="red")+geom_point()+ggtitle("Fig2:Line Chart of Avg expenses over 20 Yrs")+theme_excel()
# Plot the cusum
ggplot2(data=y, aes(x=week_id, y=weekly_revenue, group=1)) +geom_line(color="red")+geom_point()+ggtitle("Fig2:Line Chart of Avg expenses over 20 Yrs")+theme_excel()
# Plot the cusum
ggplot(data=y, aes(x=week_id, y=weekly_revenue, group=1)) +geom_line(color="red")+geom_point()+ggtitle("Fig2:Line Chart of Avg expenses over 20 Yrs")+theme_excel()
# Plot the cusum
ggplot(data=y, aes(x=week_id, y=weekly_revenue, group=1))
# Plot the cusum
ggplot(data=y, aes(x=week_id, y=weekly_revenue))
# Plot the cusum
ggplot(data=y, aes(x=week_id, y=weekly_revenue, group=1)) +geom_line(color="red")+geom_point()+ggtitle("Fig2:Line Chart of Avg expenses over 20 Yrs")+theme_excel()
# Plot the cusum
ggplot(data=y, aes(x=week_id, y=weekly_revenue)) +geom_line(color="red")+geom_point()+ggtitle("Fig2:Line Chart of Avg expenses over 20 Yrs")+theme_excel()
# Plot the cusum
ggplot(data=y, aes(x=week_id, y=weekly_revenue))+geom_line(color="red")+geom_point()+ggtitle("Fig2:Line Chart of Avg expenses over 20 Yrs")+theme_excel()
# Plot the cusum
ggplot(data=y, aes(x=week_id, y=weekly_revenue)) + geom_line(color="red")+geom_point()+ggtitle("Fig2:Line Chart of Avg expenses over 20 Yrs")+theme_excel()
# Plot the cusum
ggplot(data=y, aes(x=week_id, y=weekly_revenue)) + geom_line(color="red")+geom_point()+ggtitle("Fig2:Line Chart of Avg expenses over 20 Yrs")
# Plot the cusum
ggplot(data=y, aes(x=week_id, y=weekly_revenue, group=1)) + geom_line(color="red")+geom_point()+ggtitle("Fig2:Line Chart of Avg expenses over 20 Yrs")
tail(walmart.eval)
y <- walmart.sale['week_id', 'weekly_revenue']
y_eval <- walmart.eval['week_id', 'weekly_revenue']
summary(y)
y
y <- walmart.sale['week_id', 'weekly_revenue']
y <- subset(walmart.sale,select = c('week_id','weekly_revenue'))
y
y_eval <- subset(walmart.eval,select = c('week_id','weekly_revenue'))
y <- subset(walmart.sale, select = c('week_id','weekly_revenue'))
y_eval <- subset(walmart.eval, select = c('week_id','weekly_revenue'))
summary(y)
summary(q)
q <- cusum(y, y_eval)
install.packages('cusum')
library(cusum)
q <- cusum(y, y_eval)
y_eval <- subset(walmart.eval, select = c('weekly_revenue'))
y <- subset(walmart.sale, select = c('weekly_revenue'))
summary(y)
q <- cusum(y, y_eval)
y <- walmart.sale$weekly_revenue
y_eval <- walmart.eval$weekly_revenue
summary(y)
q <- cusum(y, y_eval)
c(walmart.sale$weekly_revenue, walmart.eval$weekly_revenue)
y <- c(walmart.sale$weekly_revenue, walmart.eval$weekly_revenue)
mean_y <- mean(y)
#calculate weekly difference (overall mean - weekly revenue)
diff <- mean_y - y
#daily difference - C
mu_x_c <- c()
for(i in 0:5){
mu_x_c <- cbind(mu_x_c, daily_diff - i)
}
mu_x_c <- cbind(mu_x_c, diff - i)
#intialize st
st <- as.data.frame(matrix(nrow=nrow(mu_x_c + 1),ncol=ncol(mu_x_c)))
st
st[1,] <- 0
for(j in 1:ncol(mu_x_c)){
for(i in 1:nrow(mu_x_c)){
value <- st[i,j] + mu_x_c[i,j]
ifelse(value < 0, st[i+1,j] <- 0, st[i+1,j] <- value)
}
}
y_week_id <- c(walmart.sale$week_id, walmart.eval$week_id)
temp_cusum <- cbind(y_week_id, st[-1,])
temp_cusum
threshold <- 5 * sd(diff)
plot(temp_cusum[,4], main = "CUSUM Results & Threshold", xlab = "Index", ylab = "S(t)")
###load packages
#clear environment
rm(list = ls())
#set seed
set.seed(273)
library(data.table)
library(outliers)
library(ggplot2)
library(qcc)
temps <- read.table("temps.txt", header=TRUE)
head(temps)
#calculate daily mean for hottest months
daily_mean <- rowMeans(temps[,-1])
#calculate overall mean
overall_mean <- mean(daily_mean[1:62])
#calculate daily difference (overall mean - daily mean to detect downward change)
daily_diff <- overall_mean - daily_mean
#daily difference - C
mu_x_c <- c()
for(i in 0:5){
mu_x_c <- cbind(mu_x_c, daily_diff - i)
}
#intialize st
st <- as.data.frame(matrix(nrow=nrow(mu_x_c + 1),ncol=ncol(mu_x_c)))
st[1,] <- 0
for(j in 1:ncol(mu_x_c)){
for(i in 1:nrow(mu_x_c)){
value <- st[i,j] + mu_x_c[i,j]
ifelse(value < 0, st[i+1,j] <- 0, st[i+1,j] <- value)
}
}
temp_cusum <- cbind(temps$DAY, st[-1,])
temp_cusum
temps$DAY
st[-1,]
y <- c(walmart.sale$weekly_revenue, walmart.eval$weekly_revenue)
y_week_id <- c(walmart.sale$week_id, walmart.eval$week_id)
# calculate mean value
mean_y <- mean(y)
#calculate weekly difference (overall mean - weekly revenue)
diff <- mean_y - y
#daily difference - C
mu_x_c <- c()
# calculate mean value
mean_y <- mean(y)
#calculate weekly difference (overall mean - weekly revenue)
diff <- mean_y - y
#daily difference - C
mu_x_c <- c()
for(i in 0:5){
mu_x_c <- cbind(mu_x_c, diff - i)
}
diff
#calculate weekly difference (overall mean - weekly revenue)
weekly_diff <- mean_y - y
#daily difference - C
mu_x_c <- c()
for(i in 0:5){
mu_x_c <- cbind(mu_x_c, weekly_diff - i)
}
#calculate weekly difference (overall mean - weekly revenue)
weekly_diff <- mean_y - y
# calculate mean value
mean_y <- mean(y)
y <- c(walmart.sale$weekly_revenue, walmart.eval$weekly_revenue)
y_week_id <- c(walmart.sale$week_id, walmart.eval$week_id)
walmart.sale <- read.csv("..\\..\\Data\\task_4_2.csv")
walmart.eval <- read.csv("..\\..\\Data\\task_5.csv")
y <- c(walmart.sale$weekly_revenue, walmart.eval$weekly_revenue)
y_week_id <- c(walmart.sale$week_id, walmart.eval$week_id)
# calculate mean value
mean_y <- mean(y)
#calculate weekly difference (overall mean - weekly revenue)
weekly_diff <- mean_y - y
#daily difference - C
mu_x_c <- c()
for(i in 0:5){
mu_x_c <- cbind(mu_x_c, weekly_diff - i)
}
#intialize st
st <- as.data.frame(matrix(nrow=nrow(mu_x_c + 1),ncol=ncol(mu_x_c)))
st[1,] <- 0
st
for(j in 1:ncol(mu_x_c)){
for(i in 1:nrow(mu_x_c)){
value <- st[i,j] + mu_x_c[i,j]
ifelse(value < 0, st[i+1,j] <- 0, st[i+1,j] <- value)
}
}
temp_cusum <- cbind(y_week_id, st[-1,])
'temp_cusum
temp_cusum
/
/n
)
temp_cusum <- cbind(y_week_id, st[-1,])
\
n
\n
temp_cusum
threshold <- 5 * sd(diff)
threshold <- 5 * sd(diff)
plot(temp_cusum[,4], main = "CUSUM Results & Threshold", xlab = "Index", ylab = "S(t)")
\n
\p
walmart.sale <- read.csv("..\\..\\Data\\task_4_2.csv")
walmart.eval <- read.csv("..\\..\\Data\\task_5.csv")
y <- c(walmart.sale$weekly_revenue, walmart.eval$weekly_revenue)
y_week_id <- c(walmart.sale$week_id, walmart.eval$week_id)
# calculate mean value
mean_y <- mean(y)
#calculate weekly difference (overall mean - weekly revenue)
weekly_diff <- mean_y - y
#daily difference - C
mu_x_c <- c()
for(i in 0:5){
mu_x_c <- cbind(mu_x_c, weekly_diff - i)
}
#intialize st
st <- as.data.frame(matrix(nrow=nrow(mu_x_c + 1),ncol=ncol(mu_x_c)))
st[1,] <- 0
for(j in 1:ncol(mu_x_c)){
for(i in 1:nrow(mu_x_c)){
value <- st[i,j] + mu_x_c[i,j]
ifelse(value < 0, st[i+1,j] <- 0, st[i+1,j] <- value)
}
}
temp_cusum <- cbind(y_week_id, st[-1,])
temp_cusum
threshold <- 5 * sd(diff)
temp_cusum
threshold <- 5 * sd(diff)
threshold <- 5 * sd(weekly_diff)
plot(temp_cusum[,4], main = "CUSUM Results & Threshold", xlab = "Index", ylab = "S(t)")
abline(h = threshold)
plot(temp_cusum[,4], main = "CUSUM Results & Threshold", xlab = "Index", ylab = "S(t)")
abline(h = threshold)
plot(temp_cusum[,4], main = "CUSUM Results & Threshold", xlab = "Index", ylab = "S(t)")
abline(h = threshold)
y <- c(walmart.sale$weekly_revenue, walmart.eval$weekly_revenue)
y_week_id <- c(walmart.sale$week_id, walmart.eval$week_id)
# calculate mean value
mean_y <- mean(y)
y
# calculate mean value
mean_y <- mean(y)
#calculate weekly difference (overall mean - weekly revenue)
weekly_diff <- mean_y - y
mean_y
#daily difference - C
mu_x_c <- c()
for(i in 0:5){
mu_x_c <- cbind(mu_x_c, weekly_diff - i)
}
#intialize st
st <- as.data.frame(matrix(nrow=nrow(mu_x_c + 1),ncol=ncol(mu_x_c)))
st[1,] <- 0
for(j in 1:ncol(mu_x_c)){
for(i in 1:nrow(mu_x_c)){
value <- st[i,j] + mu_x_c[i,j]
ifelse(value < 0, st[i+1,j] <- 0, st[i+1,j] <- value)
}
}
temp_cusum <- cbind(y_week_id, st[-1,])
temp_cusum
temp_cusum
for(i in 5000:5001){
mu_x_c <- cbind(mu_x_c, weekly_diff - i)
}
for(i in 5000:5004){
mu_x_c <- cbind(mu_x_c, weekly_diff - i)
}
#intialize st
st <- as.data.frame(matrix(nrow=nrow(mu_x_c + 1),ncol=ncol(mu_x_c)))
st[1,] <- 0
for(j in 1:ncol(mu_x_c)){
for(i in 1:nrow(mu_x_c)){
value <- st[i,j] + mu_x_c[i,j]
ifelse(value < 0, st[i+1,j] <- 0, st[i+1,j] <- value)
}
}
temp_cusum <- cbind(y_week_id, st[-1,])
temp_cusum
for(i in 50000:50004){
mu_x_c <- cbind(mu_x_c, weekly_diff - i)
}
#intialize st
st <- as.data.frame(matrix(nrow=nrow(mu_x_c + 1),ncol=ncol(mu_x_c)))
st[1,] <- 0
for(j in 1:ncol(mu_x_c)){
for(i in 1:nrow(mu_x_c)){
value <- st[i,j] + mu_x_c[i,j]
ifelse(value < 0, st[i+1,j] <- 0, st[i+1,j] <- value)
}
}
for(j in 1:ncol(mu_x_c)){
for(i in 1:nrow(mu_x_c)){
value <- st[i,j] + mu_x_c[i,j]
ifelse(value < 0, st[i+1,j] <- 0, st[i+1,j] <- value)
}
}
temp_cusum <- cbind(y_week_id, st[-1,])
temp_cusum
for(i in 500000:500004){
mu_x_c <- cbind(mu_x_c, weekly_diff - i)
}
#intialize st
st <- as.data.frame(matrix(nrow=nrow(mu_x_c + 1),ncol=ncol(mu_x_c)))
st[1,] <- 0
for(j in 1:ncol(mu_x_c)){
for(i in 1:nrow(mu_x_c)){
value <- st[i,j] + mu_x_c[i,j]
ifelse(value < 0, st[i+1,j] <- 0, st[i+1,j] <- value)
}
}
temp_cusum <- cbind(y_week_id, st[-1,])
temp_cusum
